<%@ page language="java" contentType="text/html; charset=UTF-8"    pageEncoding="UTF-8"%><%@ taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%><%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%><%@ page isELIgnored="false"%>    <%    	String path = request.getContextPath();    	String basePath = request.getScheme() + "://"    			+ request.getServerName() + ":" + request.getServerPort()    			+ path + "/";    %><!DOCTYPE html><html><head><meta charset=utf-8><title>统计管理</title><link rel="stylesheet" type="text/css" href="./pages/css/statistical.css" /><link rel="stylesheet" type="text/css" href="./pages/css/base.css" /><link href="./pages/zTreeStyle/zTreeStyle.css" rel="stylesheet"/><script src="./pages/js/jquery-2.1.3.min.js"></script><script src="./pages/js/echarts.min.js"></script><script src="./pages/My97DatePicker/WdatePicker.js"></script><script src="./pages/js/jquery.ztree.core-3.5.min.js" ></script></head><body >      <div class="manage-Monitor-title">    	<div class = "manage-Monitor-title-date">        	<img src ="./pages/img/date-logo.png" width="25px" height="25px" style="margin-left:15px;  margin-right:20px;float:left"></img>            <div style=" width:250px; height:30px; padding-left:30px;  font-size:20px; color:#FFF"  >				<script>					var now = new Date()					document.write(1900+now.getYear()+"年"+(now.getMonth()+1)+"月"+(now.getDate()+"日"))                </script>            </div>        </div>        <div class = "manage-Monitor-title-logo">        	 <img src ="./pages/img/login-logo-jt.png" width="10%" height="50%" style="margin-left:65px; margin-top:3%; margin-right:20px;float:left;"></img>             <img src ="./pages/img/login-title-jt.png" width="60%" height="50%" style=" margin-top:5%;"></img>        </div>        <div class = "manage-Monitor-title-handle">        	<div style="font-size:16px; width:56%; float:left; margin-top:2%;">        		<button class = "btn-exit"  onclick="javascript:location.href='<%=basePath%>pages/fleetmanage-main.jsp'">首页</button>				 <p id = "username" style="font-size:16px; width:60%; float:left; text-align:right;margin-right:10px">				 	  当前用户:				 </p>				 <p id = "username-value" style="font-size:14px; width:30%; float:left; color:#666">					 ${username}				 </p>			 </div>             <button  class = "btn-reflash" id="refresh" onclick="javascript:location.reload()">刷新</button>             <button id="cancel" class = "btn-exit">退出</button>        </div>       </div>        <div class = "manage-Monitor-left-menu-title" id="manage-Monitor-left-menu-title-id">     			<div class="statis-right-work-data-top-seach" style="background:#bfd9f6; 	"> 				<div class="statis-right-work-data-top-seach-type"> 					<p style=" font-size:16px; width:30%;height:26px;float:left;text-align:right">统计类型:</p>	 				 <input type="radio" name="dateType" value="2">年	 				 <input type="radio" name="dateType" value="1">月	 				 <input type="radio" name="dateType" value="0" checked="checked">日	 				 <input id="sn" type="hidden" name="sn" value=""> 				</div> 				<div class="statis-right-work-data-top-seach-date-start"> 				 	<p style=" font-size:16px; width:30%;height:26px; float:left;text-align:right">选择日期:</p>			    	 <input id="startTime"  class ="Wdate" onClick="WdatePicker()"/>			     </div>			     <div class="statis-right-work-data-top-seach-date-end">			     	<p style=" font-size:16px; width:30%;height:26px; float:left;text-align:right">至:</p>			     	<input id="endTime"  class ="Wdate" onClick="WdatePicker()"/>			     </div>			     <button class="manage-car-right-work-seach-btn-class" id="button-oil-mileage-time">检&nbsp;&nbsp;索</button>			    			</div>				    <div id="manage-Monitor-left-menu-title-panel-group">	      	<div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true" style="padding: 10px 0;" >				<div class="panel panel-default zl-panel" >					<div id="collapseOne" class="panel-collapse collapse in" role="tabpanel" aria-labelledby="headingOne" style="background:#bfd9f6">						<div id="collapseOneBody" class="panel-body" style="height: 300px; overflow-y: auto; overflow-x: hidden; #616161;">							<ul id="menuTree" class="ztree" >								</ul>						</div>					</div>				</div>			</div>	    </div>     </div>    <div class="manage-Monitor-right-work-wap" id="manage-Monitor-right-work-wap-id"> 		<button  id="manage-Monitor-right-work-data-MenuDisplay-btn" onClick="showMeaun()">》》</button>       <div class="manage-Monitor-right-work" id="manage-Monitor-right-work-id">                 <div class="manage-Monitor-right-work-data">                    <nav class="manage-Monitor-right-work-navigation-nav" >                        <ul>                        	<li class = "active">	                        	<a href="statistical">	                        	    <div style="width:30%;height:45%;margin-top:10%;margin-left:35%;background:url(./pages/img/i-4.png);background-size:100% 100%"></div>	                        		<em style="width:100%;height:30%;color:#FFF;">行程统计</em>	                        	</a>                        	</li>                        	<li>	                        	<a href="statistical_car">	                        	    <div style="width:30%;height:45%;margin-top:10%;margin-left:35%;background:url(./pages/img/i-9.png);background-size:100% 100%"></div>	                        		<em style="width:100%;height:30%;color:#FFF;">车辆统计</em>	                        	</a>                        	</li>                         	<li>	                        	<a href="statistical_warn">	                        	    <div style="width:30%;height:45%;margin-top:10%;margin-left:35%;background:url(./pages/img/i-20.png);background-size:100% 100%"></div>	                        		<em style="width:100%;height:30%;color:#FFF;">报警统计</em>	                        	</a>                        	</li>                        </ul>                    </nav>                </div>                            	<!-- 统计单辆车一段时间内单日'油耗','时长','里程'变化趋势 -->            	<!--            	<div class="statistical-chart">				<div id="chart-oil-mileage-time" style="position:relative; width:100%; height:60%;"></div>				<div style="width:600px; height:150px;overflow:scroll;">					<table id="dataTableDetail" style="align:center">						<tr>                            <th width="150px">日期</th>                            <th width="150px">耗油</th>                            <th width="150px">耗时</th>                            <th width="150px">里程</th>                        </tr>					</table>				</div>            	<script type="text/javascript">			        var myChart = echarts.init(document.getElementById('chart-oil-mileage-time'));			        myChart.setOption({			        	title: {			        		text:'统计项',			        		left:'10%',			        	},			        	tooltip : {			                trigger: 'axis'			            },			            legend: {			                data:['油耗','时长','里程']			            },			            toolbox: {			                show : true,			                orient:'vertical',			                feature : {			                    mark : {show: true},			                    dataView : {show: false, readOnly: false},			                    magicType : {show: true, type: ['line', 'bar']},			                    restore : {show: true},			                    saveAsImage : {show: true}			                }			            }, 			            xAxis: {			                data: []			            },			            yAxis: {			            	 type : 'value'			            },			        });						       // 异步加载数据			       $(function(){			    	   $("#button-oil-mileage-time").click(function(){			    		   var startTime = $("#startTime").val();			    		   var endTime = $("#endTime").val();			    		   var sn = $("#sn").val();			    		   var dateType = $("input[name='dateType']:checked").val();			    		   var url = 'http://localhost:8080/motorcadeWeb/statistical_car?startTime='+startTime+"&endTime="+endTime+"&sn="+sn+"&dateType="+dateType;			    		   $.get(url).done(function (data_car) {					    	   var data = eval(data_car);					    	   {					    		   //数据填充到表格，把data数据保存到全局变量					    		   //设定一个带有滑动条的表格显示全部数据					    		   var $table = $("#dataTableDetail");					    		   for(var i = 0; i < data.date.length ; i++){						    		   var newLine = $('<tr>'						    		   						+'<td>'+data.date[i]+'</td>'						    		   						+'<td>'+data.data_oil[i]+'</td>'						    		   						+'<td>'+data.data_time[i]+'</td>'						    		   						+'<td>'+data.data_mileage[i]+'</td>'						    				   			+'</tr>');						    		   newLine.appendTo($table);					    		   }					    	   }					           //填入数据					           myChart.setOption({					               xAxis: {					            	   type : 'category',					                   data: data.date					               },					               series: [{				           	   		name: '油耗',					                type: 'line',					                data: data.data_oil,					                /* markPoint : {					                    data : [					                        {type : 'max', name: '最大油耗'},					                        {type : 'min', name: '最小油耗'}					                    ]					                }, */					                markLine : {					                    data : [					                        {type : 'average', name: '平均油耗'}					                    ]					                }				       			},{				        	   		name: '时长',				        	   		type: 'line',					                data: data.data_time,					                /* markPoint : {					                    data : [					                        {type : 'max', name: '最大时长'},					                        {type : 'min', name: '最小时长'}					                    ]					                } ,*/					                markLine : {					                    data : [					                        {type : 'average', name: '平均时长'}					                    ]					                }				       			},{				        	   		name: '里程',				        	   		type: 'line',					                data: data.data_mileage,					                /* markPoint : {					                    data : [					                        {type : 'max', name: '最大里程'},					                        {type : 'min', name: '最小里程'}					                    ]					                }, */					                markLine : {					                    data : [					                        {type : 'average', name: '平均里程'}					                    ]					                }				       			}]					           });			    		   });			    	   })			       })			</script>            </div>            -->        </div>    </div>  <script type="text/javascript">	var work_layout =	document.getElementById('manage-Monitor-right-work-wap-id');	var zTree_menu = document.getElementById('manage-Monitor-left-menu-title-id');	var sta_layout = document.getElementById('statistical-chart');	function showMeaun(){		if(zTree_menu.style.display == "block"){			zTree_menu.style.display = "none";			$("#manage-Monitor-right-work-data-MenuDisplay-btn").html('》》');			work_layout.style.width="100%";			sta_layout.style.width = "100%";		}		else{			zTree_menu.style.display = "block";			$("#manage-Monitor-right-work-data-MenuDisplay-btn").html('《《');			work_layout.style.width="80%";				sta_layout.style.width = "100%";						}	}	//初始化ztree	var setting = {		check: {			enable: true		},		data: {			simpleData: {				enable: true			}		},		callback: {			onClick: zTreeOnClick		}	};	//点击事件回调函数	function zTreeOnClick(event, treeId, treeNode) {		//flag为1代表部门，否则表示车辆 		if(treeNode.flag == 1){			$("#sn").val("");		}else{			$("#sn").val(treeNode.id);		} 	};	var data = '${sectorDataWithCar}';	var zNodes =eval(data);	var code;	function setCheck() {		var zTree = $.fn.zTree.getZTreeObj("menuTree"),		py = "p",		sy = "s",		pn = "p",		sn = "s",		type = { "Y":py + sy, "N":pn + sn};		zTree.setting.check.chkboxType = type;		showCode('setting.check.chkboxType = { "Y" : "' + type.Y + '", "N" : "' + type.N + '" };');	}	function showCode(str) {		if (!code) code = $("#code");		code.empty();		code.append("<li>"+str+"</li>");	}	$(document).ready(function(){		$.fn.zTree.init($("#menuTree"), setting, zNodes);		setCheck();		$("#py").bind("change", setCheck);		$("#sy").bind("change", setCheck);		$("#pn").bind("change", setCheck);		$("#sn").bind("change", setCheck);	});	$("#cancel").click(function(){		if(confirm("是否确认退出当前用户?"))			window.location.href = "manager_outLogin";	});	  </script></body></html>